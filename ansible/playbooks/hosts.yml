# playbooks/hosts.yml
#
# Manages a dedicated, clearly marked block inside /etc/hosts for internal cluster name resolution.
# Using blockinfile avoids duplicated lines and makes future edits safer.

- name: Configure internal name resolution (/etc/hosts)
  hosts: heidelberg
  become: true

  vars:
    # Keep this list in sync with inventories/production/hosts.ini.
    # Format: "<ip> <hostname>"
    internal_hosts:
      - "129.206.138.101 pixel"
      - "129.206.138.69 cosmos"
      - "129.206.138.91 photon"
      - "172.24.4.103 dl0"
      - "172.24.4.97 dl2"
      - "172.24.4.101 dl3"

  tasks:
    - name: Manage internal hosts block
      ansible.builtin.blockinfile:
        path: /etc/hosts
        create: true
        marker: "# {mark} ANSIBLE MANAGED INTERNAL HOSTS"
        block: |
          {% for line in internal_hosts %}
          {{ line }}
          {% endfor %}
